# proto-file: schema/bom-1.7.proto
# proto-message: Bom

spec_version: "1.7"
version: 1
serial_number: "urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79"

components {
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "asset-1"
  name: "Name here"
  cryptoProperties {
    assetType: CRYPTO_ASSET_TYPE_ALGORITHM
    algorithmProperties {
      primitive: CRYPTO_PRIMITIVE_KEY_AGREE
      algorithmFamily: "ECDH"
      parameterSetIdentifier: "128"
      curve: "brainpool/brainpoolP160r1"
      ellipticCurve: "brainpool/brainpoolP160r1"
      executionEnvironment: CRYPTO_EXECUTION_ENVIRONMENT_SOFTWARE_PLAIN_RAM
      implementationPlatform: CRYPTO_IMPLEMENTATION_PLATFORM_X86_64
      certificationLevel: "fips140-3-l4"
      mode: CRYPTO_ALGORITHM_MODE_GCM
      padding: CRYPTO_ALGORITHM_PADDING_PKCS5
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_KEYGEN
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_KEYDERIVE
      classicalSecurityLevel: 96
      nistQuantumSecurityLevel: 0
    }
    oid: "oid:1.2.3.4.5.6.7.8.9"
  }
}
components {
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "asset-2"
  name: "Example Certificate with All Properties"
  cryptoProperties {
    assetType: CRYPTO_ASSET_TYPE_CERTIFICATE
    certificateProperties {
      serialNumber: "0B:35:82:6D:F5:7A:02:0A:0A:21:8F:BD:F3:91:43:C3"
      subjectName: "CN=example.com, O=Example Corp, C=US"
      issuerName: "CN=Example CA, O=Example Trust Services, C=US"
      notValidBefore { seconds: 1640995200 }
      notValidAfter { seconds: 1704067200 }
      signatureAlgorithmRef: "bom_ref-to-algorithm"
      subjectPublicKeyRef: "bom_ref-to-public-key"
      certificateFormat: "X.509"
      certificateExtension: "crt"
      certificateFileExtension: "crt"
      fingerprint {
        alg: HASH_ALG_SHA_256
        value: "3942447fac867ae5cdb3229b658f4d48"
      }
      certificateState {
        predefined_state: PREDEFINED_STATE_PRE_ACTIVATION
        reason: "Certificate created but not yet active"
      }
      certificateState   {
        predefined_state: PREDEFINED_STATE_ACTIVE
        reason: "Certificate in active use for TLS connections"
      }
      certificateState  {
        predefined_state: PREDEFINED_STATE_SUSPENDED
        reason: "Temporary suspension due to security audit"
      }
      certificateState  {
        predefined_state: PREDEFINED_STATE_DEACTIVATED
        reason: "Replaced by new certificate"
      }
      certificateState  {
        predefined_state: PREDEFINED_STATE_REVOKED
        reason: "Private key compromise suspected"
      }
      certificateState  {
        predefined_state: PREDEFINED_STATE_DESTROYED
        reason: "Certificate and associated keys securely destroyed"
      }
      creationDate { seconds: 1640995200 }
      activationDate { seconds: 1641081600 }
      deactivationDate { seconds: 1704067199 }
      revocationDate { seconds: 1704067200 }
      destructionDate { seconds: 1704153600 }
      certificateExtensions {
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_BASIC_CONSTRAINTS
            value: "CA:FALSE, pathlen:0"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_KEY_USAGE
            value: "digitalSignature, keyEncipherment"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_EXTENDED_KEY_USAGE
            value: "serverAuth, clientAuth"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_SUBJECT_ALTERNATIVE_NAME
            value: "DNS:example.com, DNS:www.example.com"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_AUTHORITY_KEY_IDENTIFIER
            value: "keyid:12:34:56:78:90:AB:CD:EF"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_SUBJECT_KEY_IDENTIFIER
            value: "AA:BB:CC:DD:EE:FF:00:11"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_AUTHORITY_INFORMATION_ACCESS
            value: "OCSP - URI:http://ocsp.example.com"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_CERTIFICATE_POLICIES
            value: "Policy: 2.23.140.1.2.1"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_CRL_DISTRIBUTION_POINTS
            value: "URI:http://crl.example.com/root.crl"
          }
        }
        extensions {
          commonExtension {
            name: COMMON_EXTENSION_NAME_SIGNED_CERTIFICATE_TIMESTAMP
            value: "Signed by Example CT log at 2022-01-01T00:00:00Z"
          }
        }
        extensions {
          customExtension {
            name: "someCustomExtension"
            value: "Custom value for this extension"
          }
        }
      }
      relatedCryptographicAssets {
        assets {
          type: "publicKey"
          ref: "public-key-ref"
        }
        assets {
          type: "privateKey"
          ref: "private-key-ref"
        }
        assets {
          type: "algorithm"
          ref: "signing-algorithm-ref"
        }
      }
    }
    oid: "oid:2.5.4.3"
  }
}
components {
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "asset-3"
  name: "Example Protocol with All Properties"
  cryptoProperties {
    assetType: CRYPTO_ASSET_TYPE_PROTOCOL
    protocolProperties {
      type: CRYPTO_PROTOCOL_TYPE_TLS
      version: "1.3"
      cipherSuites        {
        name: "TLS_AES_128_GCM_SHA256"
        algorithms: "aes-128-gcm-ref"
        algorithms: "sha256-ref"
        identifiers: "0x1301"
        tlsGroups: "x25519"
        tlsGroups: "secp256r1"
        tlsGroups: "secp384r1"
        tlsGroups: "secp521r1"
        tlsGroups: "ffdhe2048"
        tlsGroups: "ffdhe3072"
        tlsSignatureSchemes: "ecdsa_secp256r1_sha256"
        tlsSignatureSchemes: "ecdsa_secp384r1_sha384"
        tlsSignatureSchemes: "ecdsa_secp521r1_sha512"
        tlsSignatureSchemes: "rsa_pss_rsae_sha256"
        tlsSignatureSchemes: "rsa_pss_rsae_sha384"
        tlsSignatureSchemes: "rsa_pss_rsae_sha512"
        tlsSignatureSchemes: "ed25519"
        tlsSignatureSchemes: "ed448"
      }
      cipherSuites {
        name: "TLS_AES_256_GCM_SHA384"
        algorithms: "aes-256-gcm-ref"
        algorithms: "sha384-ref"
        identifiers: "0x1302"
      }
      cipherSuites  {
        name: "TLS_CHACHA20_POLY1305_SHA256"
        algorithms: "chacha20-poly1305-ref"
        algorithms: "sha256-ref"
        identifiers: "0x1303"
      }
      ikev2TransformTypes {
        encr {
          name: "AES-128-GCM"
          keyLength: 128
          algorithm: "aes-128-gcm-ref"
        }
        prf {
          name: "SHA-256"
          algorithm: "sha256-ref"
        }
        integ {
          name: "SHA-256"
          algorithm: "sha256-ref"
        }
        ke {
          group: 14
          algorithm: "diffie-hellman-group14-sha256-ref"
        }
        esn: true
        auth {
          name: "ECDSA"
          algorithm: "ecdsa_secp256r1_sha256"
        }
      }
    }
    oid: "oid:1.3.6.1.5.5.7.3.1"
  }
}
components {
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "asset-4"
  name: "Example Related Crypto Material with All Properties"
  cryptoProperties {
    assetType: CRYPTO_ASSET_TYPE_RELATED_CRYPTO_MATERIAL
    relatedCryptoMaterialProperties {
      type: CRYPTO_RELATED_TYPE_PUBLIC_KEY
      id: "key-12345-67890"
      state: CRYPTO_RELATED_STATE_ACTIVE
      algorithmRef: "rsa-4096-ref"
      creationDate { seconds: 1704067200 }
      activationDate { seconds: 1704153600 }
      updateDate { seconds: 1704240000 }
      expirationDate { seconds: 1767225600 }
      value: "-----BEGIN PUBLIC KEY-----"
      size: 4096
      format: "PKCS#8"
      securedBy {
        mechanism: "HSM"
        algorithmRef: "aes-256-gcm-ref"
      }
      fingerprint {
        alg: HASH_ALG_SHA_256
        value: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      }
      relatedCryptographicAssets {
        assets {
          type: "publicKey"
          ref: "corresponding-public-key-ref"
        }
        assets {
          type: "certificate"
          ref: "certificate-using-this-key-ref"
        }
        assets {
          type: "algorithm"
          ref: "rsa-4096-ref"
        }
      }
    }
    oid: "oid:1.2.840.113549.1.1.1"
  }
}
