# proto-file: schema/bom-1.7.proto
# proto-message: Bom

spec_version: "1.7"
version: 1
serial_number: "urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79"

metadata: {
  timestamp: { seconds: 1705329000 }
  component: {
    type: CLASSIFICATION_APPLICATION
    name: "enterprise-security-app"
    version: "2.1.0"
  }
}

components: {
  name: "revoked-internal-ca.example.com"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "840ADC47-55CD-44C6-A306-B37A9149B066"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_CERTIFICATE
    certificateProperties: {
      serialNumber: "ABCDEF1234567890FEDCBA"
      subjectName: "CN = internal-ca.example.com, OU = IT Security, O = Example Corp, C = US"
      issuerName: "CN = Example Root CA, O = Example Corp, C = US"
      notValidBefore: { seconds: 1672531200 }
      notValidAfter: { seconds: 1767225599 }
      certificateFormat: "X.509"
      certificateFileExtension: "pem"
      fingerprint: {
        alg: HASH_ALG_SHA_256
        value: "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
      }
      certificateState: {
        predefined_state: PREDEFINED_STATE_REVOKED
        reason: "Certificate was compromised due to private key exposure in security incident #2024-001"
      }
      creationDate: { seconds: 1671098400 }
      activationDate: { seconds: 1672531200 }
      revocationDate: { seconds: 1704901530 }
      certificateExtensions: {
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_BASIC_CONSTRAINTS
            value: "CA:TRUE, pathlen:2"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_EXTENDED_KEY_USAGE
            value: "Certificate Sign, CRL Sign, Digital Signature"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_EXTENDED_KEY_USAGE
            value: "TLS Web Server Authentication, TLS Web Client Authentication"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_SUBJECT_ALTERNATIVE_NAME
            value: "DNS:internal-ca.example.com, DNS:ca.internal.example.com, IP:192.168.1.100"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_AUTHORITY_KEY_IDENTIFIER
            value: "keyid:01:02:03:04:05:06:07:08:09:0A:0B:0C:0D:0E:0F:10:11:12:13:14"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_SUBJECT_KEY_IDENTIFIER
            value: "A1:B2:C3:D4:E5:F6:07:08:09:0A:0B:0C:0D:0E:0F:10:11:12:13:14"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_CRL_DISTRIBUTION_POINTS
            value: "URI:http://crl.example.com/root-ca.crl"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_AUTHORITY_INFORMATION_ACCESS
            value: "OCSP - URI:http://ocsp.example.com, CA Issuers - URI:http://certs.example.com/root-ca.crt"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_CERTIFICATE_POLICIES
            value: "Policy: 1.2.3.4.5.6.7.8.1, CPS: http://www.example.com/cps"
          }
        }
        extensions: {
          customExtension: {
            name: "organizationalSecurityLevel"
            value: "HIGH"
          }
        }
        extensions: {
          customExtension: {
            name: "incidentTrackingId"
            value: "SEC-2024-001"
          }
        }
        extensions: {
          customExtension: {
            name: "complianceFramework"
            value: "SOX, PCI-DSS Level 1, ISO 27001"
          }
        }
      }
      relatedCryptographicAssets: {
        assets: {
          ref: "2A0DA4D2-BBCA-4515-9BCD-C870A3EA4CE8"
          type: "algorithm"
        }
        assets: {
          ref: "ACCAF8BC-5F73-4869-A3FE-1C64E8D96408"
          type: "publicKey"
        }
      }
    }
    oid: "2.5.4.3"
  }
}
components: {
  name: "active-server.example.com"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "4497B977-4D07-4245-9457-C2CF37FF399A"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_CERTIFICATE
    certificateProperties: {
      serialNumber: "1122334455667788AABBCCDD"
      subjectName: "CN = server.example.com, OU = Web Services, O = Example Corp, C = US"
      issuerName: "CN = Example Intermediate CA, O = Example Corp, C = US"
      notValidBefore: { seconds: 1704067200 }
      notValidAfter: { seconds: 1735775999 }
      certificateFormat: "X.509"
      certificateFileExtension: "crt"
      fingerprint: {
        alg: HASH_ALG_SHA_256
        value: "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
      }
      certificateState: {
        name: "monitored"
        description: "Certificate is under enhanced monitoring due to recent security incidents"
        reason: "Proactive monitoring following organizational security policy updates"
      }
      creationDate: { seconds: 1703062800 }
      activationDate: { seconds: 1704067200 }
      certificateExtensions: {
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_KEY_USAGE
            value: "Digital Signature, Key Encipherment"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_EXTENDED_KEY_USAGE
            value: "TLS Web Server Authentication"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_SUBJECT_ALTERNATIVE_NAME
            value: "DNS:server.example.com, DNS:www.server.example.com, DNS:api.server.example.com"
          }
        }
        extensions: {
          commonExtension: {
            name: COMMON_EXTENSION_NAME_SIGNED_CERTIFICATE_TIMESTAMP
            value: "Log ID: ABCD1234..., Timestamp: 2024-01-01T00:00:00Z, Signature: 3045022100..."
          }
        }
        extensions: {
          customExtension: {
            name: "deploymentEnvironment"
            value: "PRODUCTION"
          }
        }
        extensions: {
          customExtension: {
            name: "businessCriticality"
            value: "CRITICAL"
          }
        }
        extensions: {
          customExtension: {
            name: "autoRenewalEnabled"
            value: "true"
          }
        }
      }
      relatedCryptographicAssets: {
        assets: {
          type: "algorithm"
          ref: "14478B86-9306-45B5-BA2A-1660B723244C"
        }
        assets: {
          type: "publicKey"
          ref: "F1F3D902-0A1B-4C0C-9F6A-F36E041B0B7D"
        }
      }
    }
    oid: "2.5.4.3"
  }
}
components: {
  name: "RSA-SHA256"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "2A0DA4D2-BBCA-4515-9BCD-C870A3EA4CE8"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_ALGORITHM
    algorithmProperties: {
      primitive: CRYPTO_PRIMITIVE_SIGNATURE
      executionEnvironment: CRYPTO_EXECUTION_ENVIRONMENT_SOFTWARE_PLAIN_RAM
      implementationPlatform: CRYPTO_IMPLEMENTATION_PLATFORM_X86_64
      padding: CRYPTO_ALGORITHM_PADDING_PKCS1V15
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_SIGN
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_VERIFY
    }
    oid: "1.2.840.113549.1.1.11"
  }
}
components: {
  name: "ECDSA-P256"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "14478B86-9306-45B5-BA2A-1660B723244C"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_ALGORITHM
    algorithmProperties: {
      primitive: CRYPTO_PRIMITIVE_SIGNATURE
      curve: "secp256r1"
      executionEnvironment: CRYPTO_EXECUTION_ENVIRONMENT_SOFTWARE_PLAIN_RAM
      implementationPlatform: CRYPTO_IMPLEMENTATION_PLATFORM_X86_64
      certificationLevel: "fips140-3-l1"
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_SIGN
      cryptoFunctions: CRYPTO_ALGORITHM_FUNCTION_VERIFY
    }
    oid: "1.2.840.10045.4.3.2"
  }
}
components: {
  name: "RSA-4096-Revoked-CA-Key"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "ACCAF8BC-5F73-4869-A3FE-1C64E8D96408"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_RELATED_CRYPTO_MATERIAL
    relatedCryptoMaterialProperties: {
      type: CRYPTO_RELATED_TYPE_PUBLIC_KEY
      id: "revoked-ca-key-2024"
      state: CRYPTO_RELATED_STATE_COMPROMISED
      size: 4096
      format: "PEM"
      value: "-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA...\n-----END PUBLIC KEY-----"
      creationDate: { seconds: 1671098400 }
      activationDate: { seconds: 1672531200 }
      updateDate: { seconds: 1704901530 }
      securedBy: {
        mechanism: "HSM"
        algorithmRef: "aes-256-gcm-ref"
      }
      fingerprint: {
        alg: HASH_ALG_SHA_256
        value: "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
      }
      relatedCryptographicAssets{
        assets: {
          type: "algorithm"
          ref: "2A0DA4D2-BBCA-4515-9BCD-C870A3EA4CE8"
        }
      }
    }
    oid: "1.2.840.113549.1.1.1"
  }
}
components: {
  name: "ECDSA-P256-Server-Key"
  type: CLASSIFICATION_CRYPTOGRAPHIC_ASSET
  bom_ref: "F1F3D902-0A1B-4C0C-9F6A-F36E041B0B7D"
  cryptoProperties: {
    assetType: CRYPTO_ASSET_TYPE_RELATED_CRYPTO_MATERIAL
    relatedCryptoMaterialProperties: {
      type: CRYPTO_RELATED_TYPE_PUBLIC_KEY
      id: "server-key-2024"
      state: CRYPTO_RELATED_STATE_ACTIVE
      size: 256
      format: "PEM"
      value: "-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE...\n-----END PUBLIC KEY-----"
      creationDate: { seconds: 1703062800 }
      activationDate: { seconds: 1704067200 }
      expirationDate: { seconds: 1735775999 }
      securedBy: {
        mechanism: "HSM"
        algorithmRef: "aes-256-gcm-ref"
      }
      fingerprint: {
        alg: HASH_ALG_SHA_256
        value: "d4e5f67890123456789abcdef0123456789abcdef0123456789abcdef0123456"
      }
      relatedCryptographicAssets: {
        assets: {
          type: "algorithm"
          ref: "14478B86-9306-45B5-BA2A-1660B723244C"
        }
      }
    }
    oid: "1.2.840.10045.2.1"
  }
}
