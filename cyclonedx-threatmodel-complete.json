{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://cyclonedx.org/schema/threatmodel-2.0.schema.json",
  "type": "object",
  "title": "CycloneDX Threat Model Extension",
  "description": "The CycloneDX Threat Model Extension enables comprehensive threat modeling and risk assessment within the CycloneDX ecosystem",
  "$comment": "CycloneDX Threat Model Extension v2.0",
  "required": ["modelTypes", "methodologies"],
  "additionalProperties": false,
  "properties": {
    "bom-ref": {
      "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
      "description": "An optional identifier which can be used to reference the threat model elsewhere in the BOM"
    },
    "modelTypes": {
      "type": "array",
      "minItems": 1,
      "description": "The types of models being represented",
      "items": {
        "$ref": "#/definitions/modelType"
      }
    },
    "methodologies": {
      "type": "array",
      "minItems": 1,
      "description": "The threat modeling methodologies used",
      "items": {
        "$ref": "#/definitions/methodology"
      }
    },
    "domains": {
      "type": "array",
      "description": "Risk domains covered by the threat model",
      "items": {
        "$ref": "#/definitions/riskDomain"
      }
    },
    "perspectives": {
      "type": "array",
      "description": "Different viewpoints or perspectives used in the threat model analysis",
      "items": {
        "$ref": "#/definitions/perspective"
      }
    },
    "metadata": {
      "$ref": "#/definitions/threatModelMetadata"
    },
    "scope": {
      "$ref": "#/definitions/scope"
    },
    "useCases": {
      "type": "array",
      "items": {
        "type": "object",
        "allOf": [
          {
            "$ref": "cyclonedx-usecase-2.0.schema.json"
          },
          {
            "properties": {
              "assets": {
                "type": "array",
                "items": {
                  "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
                },
                "description": "References to assets involved in this use case"
              },
              "flows": {
                "type": "array",
                "items": {
                  "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
                },
                "description": "References to flows that are part of this use case"
              },
              "requirements": {
                "type": "array",
                "items": {
                  "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
                },
                "description": "References to requirements implemented by this use case"
              }
            }
          }
        ]
      },
      "description": "Use cases analyzed as part of the threat model (PASTA methodology)"
    },
    "requirements": {
      "type": "array",
      "items": {
        "$ref": "cyclonedx-requirement-2.0.schema.json#/$defs/requirement"
      },
      "description": "Security and compliance requirements derived from the threat model"
    },
    "assets": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/asset"
      },
      "description": "The assets (components, services, data, actors) included in the threat model"
    },
    "zones": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/zone"
      },
      "description": "Security/trust zones that group assets with similar characteristics"
    },
    "boundaries": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/boundary"
      },
      "description": "Boundaries between zones (trust boundaries, network boundaries, etc.)"
    },
    "flows": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/flow"
      },
      "description": "Data, control, or process flows between assets"
    },
    "scenarios": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/scenario"
      },
      "description": "Threat/risk scenarios identified in the model"
    },
    "mitigations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/mitigation"
      },
      "description": "Controls, countermeasures, or mitigations to address identified scenarios"
    },
    "assessments": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/assessment"
      },
      "description": "Risk assessments and evaluations"
    },
    "assumptions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/assumption"
      },
      "description": "Assumptions made during the threat modeling process"
    },
    "visualizations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/visualization"
      },
      "description": "Visual representations of the threat model"
    },
    "attestations": {
      "type": "array",
      "items": {
        "$ref": "cyclonedx-attestations-2.0.schema.json#/definitions/attestation"
      },
      "description": "Attestations about the threat model's accuracy and completeness"
    },
    "evidence": {
      "type": "array",
      "items": {
        "$ref": "cyclonedx-evidence-2.0.schema.json#/definitions/evidence"
      },
      "description": "Evidence supporting the threat model findings"
    },
    "externalReferences": {
      "type": "array",
      "items": {
        "$ref": "cyclonedx-common-2.0.schema.json#/definitions/externalReference"
      },
      "description": "External references related to the threat model"
    },
    "properties": {
      "type": "array",
      "items": {
        "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
      },
      "description": "Additional properties and extensions"
    }
  },
  "definitions": {
    "modelType": {
      "type": "object",
      "oneOf": [
        {
          "required": ["type"],
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "threat",
                "risk",
                "vulnerability",
                "privacy",
                "operational",
                "safety",
                "reliability",
                "compliance",
                "combined"
              ],
              "meta:enum": {
                "threat": "Focus on identifying and analyzing security threats",
                "risk": "Comprehensive risk assessment across multiple domains",
                "vulnerability": "Vulnerability-centric analysis and assessment",
                "privacy": "Privacy impact assessment and data protection analysis",
                "operational": "Operational risk and business continuity analysis",
                "safety": "Safety-critical system analysis",
                "reliability": "System reliability and availability modeling",
                "compliance": "Compliance and regulatory requirement mapping",
                "combined": "Multiple model types combined in a single assessment"
              }
            }
          }
        },
        {
          "required": ["name"],
          "additionalProperties": false,
          "properties": {
            "name": {
              "type": "string",
              "description": "Custom model type name"
            },
            "description": {
              "type": "string",
              "description": "Description of the custom model type"
            }
          }
        }
      ]
    },
    "methodology": {
      "type": "object",
      "oneOf": [
        {
          "required": ["type"],
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "STRIDE",
                "PASTA",
                "LINDDUN",
                "OCTAVE",
                "TRIKE",
                "VAST",
                "ATTACK_TREES",
                "CVSS",
                "FAIR",
                "ISO27005",
                "NIST",
                "DREAD",
                "P.A.S.T.A",
                "SQUARE",
                "TARA",
                "hTMM"
              ],
              "meta:enum": {
                "STRIDE": "Microsoft's Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege",
                "PASTA": "Process for Attack Simulation and Threat Analysis",
                "LINDDUN": "Linkability, Identifiability, Non-repudiation, Detectability, Disclosure of information, Unawareness, Non-compliance",
                "OCTAVE": "Operationally Critical Threat, Asset, and Vulnerability Evaluation",
                "TRIKE": "Threat modeling methodology focused on defensive perspective",
                "VAST": "Visual, Agile, and Simple Threat modeling",
                "ATTACK_TREES": "Hierarchical diagrams to analyze security threats",
                "CVSS": "Common Vulnerability Scoring System",
                "FAIR": "Factor Analysis of Information Risk",
                "ISO27005": "ISO/IEC 27005 Information security risk management",
                "NIST": "NIST Risk Management Framework",
                "DREAD": "Damage, Reproducibility, Exploitability, Affected users, Discoverability",
                "P.A.S.T.A": "Process for Attack Simulation and Threat Analysis",
                "SQUARE": "Security Quality Requirements Engineering",
                "TARA": "Threat Assessment and Remediation Analysis",
                "hTMM": "Hybrid Threat Modeling Method"
              }
            },
            "version": {
              "type": "string",
              "description": "Version of the methodology"
            }
          }
        },
        {
          "required": ["name"],
          "additionalProperties": false,
          "properties": {
            "name": {
              "type": "string",
              "description": "Custom methodology name"
            },
            "version": {
              "type": "string",
              "description": "Version of the methodology"
            },
            "description": {
              "type": "string",
              "description": "Description of the custom methodology"
            },
            "externalReferences": {
              "type": "array",
              "items": {
                "$ref": "cyclonedx-common-2.0.schema.json#/definitions/externalReference"
              }
            }
          }
        }
      ]
    },
    "riskDomain": {
      "type": "object",
      "required": ["type"],
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "security",
            "privacy",
            "operational",
            "financial",
            "compliance",
            "strategic",
            "reputational",
            "safety",
            "environmental",
            "supply_chain"
          ],
          "meta:enum": {
            "security": "Information security and cybersecurity risks",
            "privacy": "Data protection and privacy risks",
            "operational": "Business operations and continuity risks",
            "financial": "Financial loss and economic impact risks",
            "compliance": "Regulatory and legal compliance risks",
            "strategic": "Strategic business and market risks",
            "reputational": "Brand and reputation damage risks",
            "safety": "Human safety and physical security risks",
            "environmental": "Environmental impact and sustainability risks",
            "supply_chain": "Supply chain and third-party risks"
          }
        },
        "priority": {
          "$ref": "#/definitions/priority"
        },
        "description": {
          "type": "string",
          "description": "Additional context for this risk domain"
        }
      }
    },
    "perspective": {
      "type": "object",
      "required": ["bom-ref", "type", "name"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Unique identifier for the perspective"
        },
        "type": {
          "type": "string",
          "enum": [
            "attacker",
            "defender",
            "business",
            "technical",
            "compliance",
            "user",
            "operational",
            "development",
            "architectural",
            "risk",
            "privacy",
            "supply-chain",
            "insider",
            "external",
            "custom"
          ],
          "meta:enum": {
            "attacker": "View from the perspective of a potential attacker or threat actor",
            "defender": "View from the perspective of security defenders and controls",
            "business": "Business stakeholder perspective focusing on business impact",
            "technical": "Technical perspective focusing on implementation details",
            "compliance": "Regulatory and compliance perspective",
            "user": "End user or customer perspective",
            "operational": "Operations and maintenance perspective",
            "development": "Software development team perspective",
            "architectural": "System architecture and design perspective",
            "risk": "Risk management and assessment perspective",
            "privacy": "Privacy and data protection perspective",
            "supply-chain": "Supply chain and third-party perspective",
            "insider": "Internal threat or insider perspective",
            "external": "External stakeholder or partner perspective",
            "custom": "Custom or other perspective"
          }
        },
        "name": {
          "type": "string",
          "description": "Name of the perspective"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the perspective and its focus"
        },
        "role": {
          "type": "string",
          "description": "The role or persona associated with this perspective"
        },
        "objectives": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Primary objectives or goals from this perspective"
        },
        "concerns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Primary concerns or risks from this perspective"
        },
        "assumptions": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to assumptions made from this perspective"
        },
        "scenarios": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to scenarios relevant to this perspective"
        },
        "mitigations": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to mitigations relevant to this perspective"
        },
        "metrics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/perspectiveMetric"
          },
          "description": "Metrics or KPIs relevant to this perspective"
        },
        "priority": {
          "$ref": "#/definitions/priority",
          "description": "Priority of this perspective in the analysis"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "perspectiveMetric": {
      "type": "object",
      "required": ["name", "value"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the metric"
        },
        "value": {
          "type": ["string", "number", "boolean"],
          "description": "Current value of the metric"
        },
        "target": {
          "type": ["string", "number"],
          "description": "Target value for the metric"
        },
        "unit": {
          "type": "string",
          "description": "Unit of measurement"
        },
        "trend": {
          "type": "string",
          "enum": ["improving", "stable", "degrading"],
          "description": "Trend direction of the metric"
        }
      }
    },
    "entityList": {
      "type": "array",
      "items": {
        "oneOf": [
          {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/organizationalContact"
          },
          {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/organizationalEntity"
          },
          {
            "type": "string",
            "description": "Simple name when full details are not available"
          }
        ]
      }
    },
    "threatModelMetadata": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When the threat model was created or last updated"
        },
        "authors": {
          "$ref": "#/definitions/entityList",
          "description": "The person(s) or organization(s) who created the threat model"
        },
        "reviewer": {
          "$ref": "#/definitions/entityList",
          "description": "The person(s) or organization(s) who reviewed the threat model"
        },
        "reviewDate": {
          "type": "string",
          "format": "date-time",
          "description": "When the threat model was reviewed"
        },
        "approver": {
          "$ref": "#/definitions/entityList",
          "description": "The person(s) or organization(s) who approved the threat model"
        },
        "approvalDate": {
          "type": "string",
          "format": "date-time",
          "description": "When the threat model was approved"
        },
        "version": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/version",
          "description": "Version of the threat model"
        },
        "lifecycles": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/lifecycle"
          },
          "description": "The lifecycle phases this threat model represents"
        },
        "validityPeriod": {
          "$ref": "#/definitions/validityPeriod"
        }
      }
    },
    "validityPeriod": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "start": {
          "type": "string",
          "format": "date-time",
          "description": "When the threat model becomes valid"
        },
        "end": {
          "type": "string",
          "format": "date-time",
          "description": "When the threat model expires"
        },
        "reviewFrequency": {
          "type": "string",
          "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(\\d+H)?(\\d+M)?(\\d+(\\.\\d+)?S)?)?$",
          "description": "Recovery time as ISO 8601 duration"
        }
      }
    },
    "riskScore": {
      "type": "object",
      "required": ["level"],
      "additionalProperties": false,
      "properties": {
        "level": {
          "type": "string",
          "enum": ["info", "low", "medium", "high", "critical"],
          "description": "Overall risk level",
          "meta:enum": {
            "info": "Informational - no immediate action required",
            "low": "Low risk - monitor and address in normal cycle",
            "medium": "Medium risk - plan mitigation activities",
            "high": "High risk - prioritize mitigation efforts",
            "critical": "Critical risk - immediate action required"
          }
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Numeric risk score"
        },
        "vector": {
          "type": "string",
          "description": "Risk scoring vector (e.g., CVSS vector string)"
        },
        "methodology": {
          "type": "string",
          "description": "Risk scoring methodology used"
        },
        "residualRisk": {
          "$ref": "#/definitions/residualRisk"
        }
      }
    },
    "residualRisk": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "level": {
          "type": "string",
          "enum": ["info", "low", "medium", "high", "critical"]
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "acceptanceStatus": {
          "type": "string",
          "enum": ["accepted", "notAccepted", "conditional"],
          "meta:enum": {
            "accepted": "Residual risk is accepted",
            "notAccepted": "Residual risk is not accepted",
            "conditional": "Accepted under specific conditions"
          }
        },
        "acceptedBy": {
          "$ref": "#/definitions/entityList"
        },
        "acceptanceDate": {
          "type": "string",
          "format": "date-time"
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Conditions for acceptance"
        }
      }
    },
    "priority": {
      "type": "string",
      "enum": ["none", "low", "medium", "high", "critical"],
      "description": "Priority level",
      "meta:enum": {
        "none": "No priority assigned",
        "low": "Low priority - address when convenient",
        "medium": "Medium priority - address in normal cycle",
        "high": "High priority - address soon",
        "critical": "Critical priority - address immediately"
      }
    },
    "severity": {
      "type": "string",
      "enum": ["info", "low", "medium", "high", "critical"],
      "description": "Severity level",
      "meta:enum": {
        "info": "Informational finding",
        "low": "Low severity issue",
        "medium": "Medium severity issue",
        "high": "High severity issue",
        "critical": "Critical severity issue"
      }
    },
    "threatActor": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string",
          "enum": ["individual", "group", "organization", "nation-state", "automated"],
          "meta:enum": {
            "individual": "Individual threat actor",
            "group": "Organized group or collective",
            "organization": "Corporate or criminal organization",
            "nation-state": "Nation-state sponsored actor",
            "automated": "Automated system or bot"
          }
        },
        "sophistication": {
          "type": "string",
          "enum": ["none", "minimal", "intermediate", "advanced", "expert"],
          "meta:enum": {
            "none": "No technical sophistication",
            "minimal": "Script kiddie level",
            "intermediate": "Intermediate technical skills",
            "advanced": "Advanced persistent threat",
            "expert": "Nation-state level capabilities"
          }
        },
        "motivation": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "financial",
              "political",
              "personal",
              "ideological",
              "espionage",
              "destruction",
              "disruption",
              "reputation",
              "curiosity",
              "competitive"
            ],
            "meta:enum": {
              "financial": "Financial gain",
              "political": "Political objectives",
              "personal": "Personal grievance or revenge",
              "ideological": "Ideological or activist goals",
              "espionage": "Information gathering",
              "destruction": "Destructive intent",
              "disruption": "Service disruption",
              "reputation": "Reputation or notoriety",
              "curiosity": "Curiosity or challenge",
              "competitive": "Competitive advantage"
            }
          },
          "description": "Motivations of the threat actor"
        },
        "capability": {
          "type": "string",
          "enum": ["minimal", "limited", "moderate", "significant", "advanced"],
          "description": "Capability level of the threat actor"
        },
        "intent": {
          "type": "string",
          "enum": ["accidental", "opportunistic", "targeted", "persistent"],
          "description": "Intent level"
        },
        "resources": {
          "type": "string",
          "enum": ["minimal", "limited", "moderate", "substantial", "unlimited"],
          "meta:enum": {
            "minimal": "Minimal resources",
            "limited": "Limited resources",
            "moderate": "Moderate resources",
            "substantial": "Substantial resources",
            "unlimited": "Effectively unlimited resources"
          }
        },
        "access": {
          "type": "string",
          "enum": ["none", "external", "internal", "privileged", "physical"],
          "meta:enum": {
            "none": "No special access",
            "external": "External network access",
            "internal": "Internal network access",
            "privileged": "Privileged account access",
            "physical": "Physical access to systems"
          }
        }
      }
    },
    "attackPattern": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "capecId": {
          "type": "integer",
          "description": "CAPEC (Common Attack Pattern Enumeration and Classification) ID"
        },
        "name": {
          "type": "string",
          "description": "Name of the attack pattern"
        },
        "description": {
          "type": "string",
          "description": "Description of the attack pattern"
        },
        "severity": {
          "$ref": "#/definitions/severity"
        },
        "prerequisites": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Prerequisites for the attack"
        },
        "techniques": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/technique"
          },
          "description": "Techniques used in the attack"
        }
      }
    },
    "technique": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Technique ID (e.g., MITRE ATT&CK ID)"
        },
        "name": {
          "type": "string",
          "description": "Name of the technique"
        },
        "tactic": {
          "type": "string",
          "description": "Associated tactic"
        },
        "procedure": {
          "type": "string",
          "description": "Specific procedure"
        }
      }
    },
    "weakness": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "cweId": {
          "type": "integer",
          "description": "CWE (Common Weakness Enumeration) ID"
        },
        "name": {
          "type": "string",
          "description": "Name of the weakness"
        },
        "description": {
          "type": "string",
          "description": "Description of the weakness"
        },
        "abstraction": {
          "type": "string",
          "enum": ["pillar", "class", "base", "variant", "compound"],
          "meta:enum": {
            "pillar": "Most abstract type of weakness",
            "class": "Weakness described in generic terms",
            "base": "Weakness described in abstract terms",
            "variant": "Weakness specific to a resource/technology",
            "compound": "Combination of two or more weaknesses"
          }
        },
        "ordinality": {
          "type": "string",
          "enum": ["primary", "resultant", "indirect"],
          "meta:enum": {
            "primary": "Weakness exists independent of other weaknesses",
            "resultant": "Weakness is caused by another weakness",
            "indirect": "Weakness is indirectly caused by another weakness"
          }
        }
      }
    },
    "exploitability": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "level": {
          "type": "string",
          "enum": ["theoretical", "proof-of-concept", "functional", "weaponized"],
          "meta:enum": {
            "theoretical": "Theoretically possible but not demonstrated",
            "proof-of-concept": "Proof of concept exists",
            "functional": "Functional exploit exists",
            "weaponized": "Weaponized exploit in the wild"
          }
        },
        "complexity": {
          "type": "string",
          "enum": ["trivial", "low", "medium", "high", "very-high"],
          "meta:enum": {
            "trivial": "Trivial to exploit",
            "low": "Low complexity to exploit",
            "medium": "Medium complexity to exploit",
            "high": "High complexity to exploit",
            "very-high": "Very high complexity to exploit"
          }
        },
        "skillRequired": {
          "type": "string",
          "enum": ["none", "basic", "intermediate", "advanced", "expert"],
          "meta:enum": {
            "none": "No special skills required",
            "basic": "Basic technical skills",
            "intermediate": "Intermediate technical skills",
            "advanced": "Advanced technical skills",
            "expert": "Expert-level skills required"
          }
        },
        "toolsRequired": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tools required for exploitation"
        },
        "indicators": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Indicators of exploitation"
        }
      }
    }
  }
}\\d+M)?(\\d+W)?(\\d+D)?$",
          "description": "ISO 8601 duration for review frequency (e.g., P3M for quarterly)"
        }
      }
    },
    "scope": {
      "type": "object",
      "required": ["description"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name of the scope"
        },
        "description": {
          "type": "string",
          "description": "Description of what is included and excluded from the threat model"
        },
        "boundaries": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Explicit boundaries of the assessment"
        },
        "includedComponents": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to components explicitly included"
        },
        "excludedComponents": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to components explicitly excluded"
        },
        "criticality": {
          "$ref": "#/definitions/criticality"
        },
        "dataSensitivity": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataSensitivity"
          },
          "description": "Types of sensitive data handled within scope"
        },
        "businessContext": {
          "type": "string",
          "description": "Business context and importance"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "asset": {
      "type": "object",
      "required": ["bom-ref", "type", "name"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Unique identifier for the asset"
        },
        "componentRef": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to the component this asset represents"
        },
        "serviceRef": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to the service this asset represents"
        },
        "type": {
          "type": "string",
          "enum": [
            "component",
            "service",
            "dataStore",
            "data",
            "actor",
            "process",
            "infrastructure",
            "device",
            "network",
            "container",
            "function",
            "api",
            "queue",
            "stream"
          ],
          "meta:enum": {
            "component": "Software component or application",
            "service": "Service or microservice",
            "dataStore": "Database, file system, or data repository",
            "data": "Data asset or dataset",
            "actor": "User, system, or external entity",
            "process": "Business or system process",
            "infrastructure": "Infrastructure component",
            "device": "Physical or IoT device",
            "network": "Network segment or resource",
            "container": "Container or orchestration unit",
            "function": "Serverless function or lambda",
            "api": "API endpoint or interface",
            "queue": "Message queue or event bus",
            "stream": "Data stream or event stream"
          }
        },
        "name": {
          "type": "string",
          "description": "Name of the asset"
        },
        "description": {
          "type": "string",
          "description": "Description of the asset's role and purpose"
        },
        "zone": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to the zone containing this asset"
        },
        "parent": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to parent asset if this is a sub-component"
        },
        "criticality": {
          "$ref": "#/definitions/criticality"
        },
        "classification": {
          "$ref": "#/definitions/assetClassification"
        },
        "riskAttributes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskAttribute"
          },
          "description": "Security and privacy attributes relevant to this asset"
        },
        "useCases": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to use cases that involve this asset"
        },
        "authentication": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/authenticationType"
          },
          "description": "Authentication methods supported/required"
        },
        "authorization": {
          "$ref": "#/definitions/authorizationType",
          "description": "Authorization model used"
        },
        "encryption": {
          "$ref": "#/definitions/encryptionType"
        },
        "ownership": {
          "$ref": "#/definitions/ownership"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        },
        "externalReferences": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/externalReference"
          }
        }
      }
    },
    "zone": {
      "type": "object",
      "required": ["bom-ref", "name", "type"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name of the zone"
        },
        "description": {
          "type": "string",
          "description": "Description of the zone's characteristics"
        },
        "type": {
          "type": "string",
          "enum": ["trust", "network", "physical", "logical", "regulatory", "organizational"],
          "meta:enum": {
            "trust": "Security trust zone",
            "network": "Network segmentation zone",
            "physical": "Physical location or boundary",
            "logical": "Logical grouping or boundary",
            "regulatory": "Regulatory compliance boundary",
            "organizational": "Organizational or administrative boundary"
          }
        },
        "trustLevel": {
          "type": "string",
          "enum": ["untrusted", "low", "medium", "high", "critical"],
          "meta:enum": {
            "untrusted": "No trust - typically external/public zones",
            "low": "Minimal trust - limited access zones",
            "medium": "Moderate trust - internal zones with standard controls",
            "high": "High trust - restricted access zones",
            "critical": "Critical trust - highly secured zones"
          }
        },
        "riskAttributes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskAttribute"
          },
          "description": "Default risk attributes for assets in this zone"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "boundary": {
      "type": "object",
      "required": ["bom-ref", "zones"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name of the boundary"
        },
        "type": {
          "type": "string",
          "enum": ["trust", "network", "process", "data", "physical"],
          "meta:enum": {
            "trust": "Trust boundary between different security zones",
            "network": "Network boundary or firewall",
            "process": "Process or privilege boundary",
            "data": "Data classification boundary",
            "physical": "Physical security boundary"
          }
        },
        "zones": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "The two zones this boundary separates"
        },
        "crossingRequirements": {
          "$ref": "#/definitions/crossingRequirements"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "crossingRequirements": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "authentication": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/authenticationType"
          },
          "description": "Authentication required to cross this boundary"
        },
        "authorization": {
          "$ref": "#/definitions/authorizationType",
          "description": "Authorization model at this boundary"
        },
        "dataValidation": {
          "type": "boolean",
          "description": "Whether data is validated when crossing this boundary"
        },
        "encryption": {
          "$ref": "#/definitions/encryptionType",
          "description": "Encryption requirements for data crossing this boundary"
        },
        "logging": {
          "type": "boolean",
          "description": "Whether crossings are logged"
        },
        "rateLimit": {
          "type": "string",
          "description": "Rate limiting policy"
        }
      }
    },
    "flow": {
      "type": "object",
      "required": ["bom-ref", "name", "source", "destination", "type"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name or description of the flow"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of what flows and why"
        },
        "type": {
          "type": "string",
          "enum": ["data", "control", "authentication", "process"],
          "meta:enum": {
            "data": "Data or information flow",
            "control": "Control or command flow",
            "authentication": "Authentication/authorization flow",
            "process": "Business process flow"
          }
        },
        "source": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to the source asset"
        },
        "destination": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType",
          "description": "Reference to the destination asset"
        },
        "bidirectional": {
          "type": "boolean",
          "default": false,
          "description": "Whether flow occurs in both directions"
        },
        "classification": {
          "$ref": "#/definitions/dataClassification"
        },
        "volume": {
          "type": "string",
          "description": "Expected volume or frequency of flow"
        },
        "protocol": {
          "type": "string",
          "description": "Communication protocol used"
        },
        "port": {
          "type": "integer",
          "description": "Network port if applicable"
        },
        "encryption": {
          "$ref": "#/definitions/encryptionType"
        },
        "authentication": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/authenticationType"
          }
        },
        "riskAttributes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskAttribute"
          },
          "description": "Risk attributes affected by this flow"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "scenario": {
      "type": "object",
      "required": ["bom-ref", "name", "type"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name of the threat/risk scenario"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the scenario"
        },
        "type": {
          "type": "string",
          "enum": ["threat", "vulnerability", "weakness", "risk", "incident", "misuse", "abuse"],
          "meta:enum": {
            "threat": "Security threat scenario",
            "vulnerability": "Exploitable vulnerability",
            "weakness": "System or design weakness",
            "risk": "General risk scenario",
            "incident": "Potential incident scenario",
            "misuse": "Unintended use scenario",
            "abuse": "Malicious use scenario"
          }
        },
        "domain": {
          "$ref": "#/definitions/riskDomain"
        },
        "perspectives": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to perspectives from which this scenario is analyzed"
        },
        "category": {
          "type": "string",
          "description": "Category based on the methodology (e.g., STRIDE category)"
        },
        "relatedUseCases": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to related use cases"
        },
        "relatedRequirements": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to related requirements"
        },
        "likelihood": {
          "$ref": "#/definitions/likelihood"
        },
        "impact": {
          "$ref": "#/definitions/impact"
        },
        "riskScore": {
          "$ref": "#/definitions/riskScore"
        },
        "riskAttributes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskAttribute"
          },
          "description": "Risk attributes affected by this scenario"
        },
        "affectedAssets": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to affected assets"
        },
        "affectedFlows": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to affected flows"
        },
        "threatActor": {
          "$ref": "#/definitions/threatActor"
        },
        "attackPattern": {
          "$ref": "#/definitions/attackPattern"
        },
        "weakness": {
          "$ref": "#/definitions/weakness"
        },
        "exploitability": {
          "$ref": "#/definitions/exploitability"
        },
        "mitigations": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to mitigations that address this scenario"
        },
        "evidence": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to evidence supporting this scenario"
        },
        "externalReferences": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/externalReference"
          }
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "mitigation": {
      "type": "object",
      "required": ["bom-ref", "name", "type"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name of the mitigation"
        },
        "description": {
          "type": "string",
          "description": "Description of what the mitigation does"
        },
        "type": {
          "type": "string",
          "enum": [
            "control",
            "countermeasure",
            "safeguard",
            "practice",
            "procedure",
            "detection",
            "response",
            "recovery",
            "transfer",
            "acceptance"
          ],
          "meta:enum": {
            "control": "Preventive or detective security control",
            "countermeasure": "Reactive measure to counter specific threats",
            "safeguard": "Protective measure or safety control",
            "practice": "Security practice or process",
            "procedure": "Documented procedure or protocol",
            "detection": "Detection mechanism or monitoring",
            "response": "Incident response measure",
            "recovery": "Recovery or restoration measure",
            "transfer": "Risk transfer mechanism (e.g., insurance)",
            "acceptance": "Documented risk acceptance"
          }
        },
        "strategy": {
          "type": "string",
          "enum": ["prevent", "detect", "respond", "recover", "transfer"],
          "meta:enum": {
            "prevent": "Prevents the scenario from occurring",
            "detect": "Detects when the scenario occurs",
            "respond": "Responds to the scenario when detected",
            "recover": "Recovers from the impact of the scenario",
            "transfer": "Transfers the risk to another party"
          }
        },
        "status": {
          "type": "string",
          "enum": ["proposed", "planned", "inProgress", "implemented", "verified", "notApplicable"],
          "meta:enum": {
            "proposed": "Mitigation has been proposed but not approved",
            "planned": "Mitigation is approved and planned for implementation",
            "inProgress": "Mitigation implementation is in progress",
            "implemented": "Mitigation has been implemented",
            "verified": "Mitigation has been implemented and verified effective",
            "notApplicable": "Mitigation is not applicable in this context"
          }
        },
        "priority": {
          "$ref": "#/definitions/priority"
        },
        "effectiveness": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Estimated effectiveness as a percentage"
        },
        "cost": {
          "type": "string",
          "enum": ["trivial", "low", "medium", "high", "extreme"],
          "meta:enum": {
            "trivial": "Minimal cost and effort",
            "low": "Low cost and effort",
            "medium": "Moderate cost and effort",
            "high": "High cost and significant effort",
            "extreme": "Extreme cost and major effort"
          }
        },
        "timeframe": {
          "type": "string",
          "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?$",
          "description": "Expected implementation timeframe as ISO 8601 duration"
        },
        "implementedBy": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to assets that implement this mitigation"
        },
        "addresses": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to scenarios this mitigation addresses"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "References to other mitigations this depends on"
        },
        "externalReferences": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/externalReference"
          }
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "assessment": {
      "type": "object",
      "required": ["bom-ref", "type", "timestamp"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "type": {
          "type": "string",
          "enum": ["initial", "periodic", "continuous", "triggered"],
          "meta:enum": {
            "initial": "Initial risk assessment",
            "periodic": "Scheduled periodic assessment",
            "continuous": "Continuous monitoring assessment",
            "triggered": "Event-triggered assessment"
          }
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When the assessment was performed"
        },
        "assessor": {
          "$ref": "#/definitions/entityList",
          "description": "Who performed the assessment"
        },
        "methodology": {
          "$ref": "#/definitions/methodology",
          "description": "Methodology used for this assessment"
        },
        "summary": {
          "type": "string",
          "description": "Executive summary of the assessment"
        },
        "findings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/finding"
          },
          "description": "Specific findings from the assessment"
        },
        "overallRisk": {
          "$ref": "#/definitions/riskScore",
          "description": "Overall risk score/level"
        },
        "recommendations": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Recommendations from the assessment"
        },
        "nextReview": {
          "type": "string",
          "format": "date-time",
          "description": "When the next review should occur"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "finding": {
      "type": "object",
      "required": ["title", "severity"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "title": {
          "type": "string",
          "description": "Title of the finding"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the finding"
        },
        "severity": {
          "$ref": "#/definitions/severity"
        },
        "relatedScenarios": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "Scenarios related to this finding"
        },
        "relatedAssets": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "Assets affected by this finding"
        },
        "remediation": {
          "type": "string",
          "description": "Recommended remediation"
        },
        "status": {
          "type": "string",
          "enum": ["open", "inProgress", "resolved", "accepted", "transferred"],
          "meta:enum": {
            "open": "Finding is open and unaddressed",
            "inProgress": "Remediation is in progress",
            "resolved": "Finding has been resolved",
            "accepted": "Risk has been accepted",
            "transferred": "Risk has been transferred"
          }
        }
      }
    },
    "assumption": {
      "type": "object",
      "required": ["description"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "description": {
          "type": "string",
          "description": "The assumption being made"
        },
        "relatedAssets": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
          },
          "description": "Assets this assumption relates to"
        },
        "validity": {
          "type": "string",
          "enum": ["unknown", "verified", "unverified", "invalid"],
          "default": "unknown",
          "description": "Whether the assumption has been validated"
        },
        "impact": {
          "type": "string",
          "description": "Impact if this assumption proves false"
        }
      }
    },
    "visualization": {
      "type": "object",
      "required": ["name", "type"],
      "additionalProperties": false,
      "properties": {
        "bom-ref": {
          "$ref": "cyclonedx-common-2.0.schema.json#/definitions/refType"
        },
        "name": {
          "type": "string",
          "description": "Name or title of the visualization"
        },
        "description": {
          "type": "string",
          "description": "Description of what the visualization shows"
        },
        "type": {
          "type": "string",
          "enum": [
            "architecture",
            "dataFlow",
            "sequence",
            "state",
            "deployment",
            "threatTree",
            "attackTree",
            "riskMatrix",
            "heatMap",
            "network",
            "process"
          ],
          "meta:enum": {
            "architecture": "System architecture diagram",
            "dataFlow": "Data flow diagram (DFD)",
            "sequence": "Sequence or interaction diagram",
            "state": "State machine diagram",
            "deployment": "Deployment or infrastructure diagram",
            "threatTree": "Threat tree analysis",
            "attackTree": "Attack tree visualization",
            "riskMatrix": "Risk assessment matrix",
            "heatMap": "Risk or threat heat map",
            "network": "Network topology diagram",
            "process": "Business process diagram"
          }
        },
        "format": {
          "type": "string",
          "enum": ["mermaid", "graphviz", "plantuml", "drawio", "svg", "png", "jpeg", "d3", "cytoscape"],
          "meta:enum": {
            "mermaid": "Mermaid diagram language",
            "graphviz": "GraphViz DOT language",
            "plantuml": "PlantUML diagram language",
            "drawio": "Draw.io/diagrams.net format",
            "svg": "Scalable Vector Graphics",
            "png": "Portable Network Graphics",
            "jpeg": "JPEG image format",
            "d3": "D3.js visualization",
            "cytoscape": "Cytoscape graph format"
          }
        },
        "content": {
          "type": "string",
          "description": "The diagram content (source code or base64 encoded image)"
        },
        "url": {
          "type": "string",
          "format": "iri-reference",
          "description": "URL to the diagram if stored externally"
        },
        "interactive": {
          "type": "boolean",
          "description": "Whether the visualization is interactive"
        },
        "layers": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Layers or views available in the visualization"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "cyclonedx-common-2.0.schema.json#/definitions/property"
          }
        }
      }
    },
    "riskAttribute": {
      "type": "string",
      "description": "A classification of security and privacy attributes that represent potential impact areas when a threat is realised. These attributes help identify what is at risk, and can also be used to prioritise which attributes are most important to protect for a given application, system, or threat model.",
      "enum": [
        "accountability",
        "authentication",
        "authorization",
        "authenticity",
        "availability",
        "compliance",
        "confidentiality",
        "connectivity",
        "control",
        "data_subject_rights",
        "integrity",
        "minimisation",
        "non-repudiation",
        "possession",
        "privacy",
        "purpose_limitation",
        "transparency",
        "utility"
      ],
      "meta:enum": {
        "accountability": "Assigning responsibility for actions and decisions to individuals or entities.",
        "authentication": "Verifying the identity of users, devices, or systems before granting access.",
        "authorization": "Granting permissions based on identity and roles to perform specific actions or access resources.",
        "authenticity": "Ensuring that data, communications, or entities are genuine and can be verified.",
        "availability": "Ensuring systems, data, and services are accessible and operational when needed.",
        "compliance": "Adherence to applicable laws, regulations, policies, and standards.",
        "confidentiality": "Preventing unauthorised access to or disclosure of information.",
        "connectivity": "Maintaining secure and reliable communication between systems or components.",
        "control": "Enabling individuals to manage how their personal data is used and shared.",
        "data_subject_rights": "Guaranteeing individuals' rights to access, correct, delete, or restrict their personal data.",
        "integrity": "Ensuring information is accurate, complete, and unaltered by unauthorised actors.",
        "minimisation": "Limiting data collection and retention to what is strictly necessary for the intended purpose.",
        "non-repudiation": "Providing proof of origin and delivery to prevent denial of actions or communications.",
        "possession": "Ensuring control or custody over data or assets, regardless of ownership.",
        "privacy": "Protecting individuals' personal information in accordance with legal and ethical standards.",
        "purpose_limitation": "Ensuring that personal data is only used for the purpose explicitly specified at collection.",
        "transparency": "Ensuring individuals are informed about data practices, including collection, use, and sharing.",
        "utility": "Ensuring data is usable and in a format suitable for the intended purpose."
      }
    },
    "criticality": {
      "type": "string",
      "enum": ["minimal", "low", "moderate", "high", "critical"],
      "description": "Business criticality level",
      "meta:enum": {
        "minimal": "Minimal impact on business operations",
        "low": "Low impact with minor inconvenience",
        "moderate": "Moderate impact affecting some operations",
        "high": "High impact affecting critical operations",
        "critical": "Critical impact with severe business consequences"
      }
    },
    "dataSensitivity": {
      "type": "string",
      "enum": ["public", "internal", "confidential", "restricted", "pii", "phi", "pci", "classified"],
      "description": "Data sensitivity classification",
      "meta:enum": {
        "public": "Public information that can be freely shared",
        "internal": "Internal use only within the organization",
        "confidential": "Confidential information requiring protection",
        "restricted": "Highly restricted information with limited access",
        "pii": "Personally Identifiable Information",
        "phi": "Protected Health Information",
        "pci": "Payment Card Industry data",
        "classified": "Government classified information"
      }
    },
    "assetClassification": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dataClassification": {
          "$ref": "#/definitions/dataClassification"
        },
        "tier": {
          "type": "string",
          "enum": ["tier0", "tier1", "tier2", "tier3", "tier4"],
          "meta:enum": {
            "tier0": "Mission critical - highest priority",
            "tier1": "Business critical - high priority",
            "tier2": "Business important - medium priority",
            "tier3": "Business supporting - low priority",
            "tier4": "Non-critical - minimal priority"
          }
        },
        "regulatory": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Regulatory frameworks that apply"
        }
      }
    },
    "dataClassification": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "sensitivity": {
          "$ref": "#/definitions/dataSensitivity"
        },
        "dataTypes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Specific types of data (e.g., 'credit-card', 'ssn', 'medical-records')"
        },
        "retention": {
          "type": "string",
          "description": "Data retention requirements"
        },
        "regulations": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Applicable regulations (e.g., 'GDPR', 'HIPAA', 'PCI-DSS')"
        }
      }
    },
    "ownership": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "owner": {
          "$ref": "#/definitions/entityList",
          "description": "Primary owner of the asset"
        },
        "custodian": {
          "$ref": "#/definitions/entityList",
          "description": "Custodian responsible for protecting the asset"
        },
        "steward": {
          "$ref": "#/definitions/entityList",
          "description": "Data steward responsible for governance"
        }
      }
    },
    "authenticationType": {
      "type": "string",
      "enum": [
        "none",
        "password",
        "mfa",
        "certificate",
        "token",
        "apiKey",
        "oauth",
        "saml",
        "kerberos",
        "biometric",
        "jwt",
        "oidc",
        "ldap"
      ],
      "description": "Authentication method",
      "meta:enum": {
        "none": "No authentication required",
        "password": "Username and password authentication",
        "mfa": "Multi-factor authentication",
        "certificate": "Certificate-based authentication",
        "token": "Token-based authentication",
        "apiKey": "API key authentication",
        "oauth": "OAuth 2.0 authentication",
        "saml": "SAML-based authentication",
        "kerberos": "Kerberos authentication",
        "biometric": "Biometric authentication",
        "jwt": "JSON Web Token authentication",
        "oidc": "OpenID Connect authentication",
        "ldap": "LDAP authentication"
      }
    },
    "authorizationType": {
      "type": "string",
      "enum": ["none", "acl", "rbac", "abac", "mac", "dac", "pbac", "cbac", "custom"],
      "description": "Authorization model",
      "meta:enum": {
        "none": "No authorization controls",
        "acl": "Access Control Lists",
        "rbac": "Role-Based Access Control",
        "abac": "Attribute-Based Access Control",
        "mac": "Mandatory Access Control",
        "dac": "Discretionary Access Control",
        "pbac": "Policy-Based Access Control",
        "cbac": "Context-Based Access Control",
        "custom": "Custom authorization model"
      }
    },
    "encryptionType": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "inTransit": {
          "type": "boolean",
          "description": "Whether data is encrypted in transit"
        },
        "atRest": {
          "type": "boolean",
          "description": "Whether data is encrypted at rest"
        },
        "algorithm": {
          "type": "string",
          "description": "Encryption algorithm used"
        },
        "keyManagement": {
          "type": "string",
          "description": "Key management approach"
        }
      }
    },
    "likelihood": {
      "type": "object",
      "required": ["level"],
      "additionalProperties": false,
      "properties": {
        "level": {
          "type": "string",
          "enum": ["veryLow", "low", "medium", "high", "veryHigh", "certain"],
          "description": "Likelihood level",
          "meta:enum": {
            "veryLow": "Very unlikely to occur (< 10%)",
            "low": "Unlikely to occur (10-30%)",
            "medium": "Possible to occur (30-60%)",
            "high": "Likely to occur (60-90%)",
            "veryHigh": "Very likely to occur (> 90%)",
            "certain": "Will certainly occur (100%)"
          }
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10,
          "description": "Numeric likelihood score"
        },
        "probability": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Probability as a decimal (0-1)"
        },
        "frequency": {
          "type": "string",
          "description": "Expected frequency (e.g., 'daily', 'monthly', 'yearly')"
        },
        "rationale": {
          "type": "string",
          "description": "Justification for the likelihood rating"
        },
        "factors": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Factors contributing to the likelihood"
        }
      }
    },
    "impact": {
      "type": "object",
      "required": ["level"],
      "additionalProperties": false,
      "properties": {
        "level": {
          "type": "string",
          "enum": ["negligible", "low", "moderate", "high", "severe", "catastrophic"],
          "description": "Impact severity level",
          "meta:enum": {
            "negligible": "Minimal impact with no significant consequences",
            "low": "Minor impact with limited consequences",
            "moderate": "Moderate impact affecting some operations",
            "high": "Significant impact with serious consequences",
            "severe": "Severe impact with critical consequences",
            "catastrophic": "Catastrophic impact with existential consequences"
          }
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 10,
          "description": "Numeric impact score"
        },
        "categories": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "confidentiality",
              "integrity",
              "availability",
              "financial",
              "reputation",
              "regulatory",
              "safety",
              "privacy",
              "operational",
              "strategic"
            ],
            "meta:enum": {
              "confidentiality": "Impact on data confidentiality",
              "integrity": "Impact on data or system integrity",
              "availability": "Impact on service availability",
              "financial": "Financial loss or impact",
              "reputation": "Reputational damage",
              "regulatory": "Regulatory compliance impact",
              "safety": "Human safety impact",
              "privacy": "Privacy violation impact",
              "operational": "Operational disruption",
              "strategic": "Strategic business impact"
            }
          },
          "description": "Categories of impact"
        },
        "riskAttributes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskAttribute"
          },
          "description": "Risk attributes affected"
        },
        "quantification": {
          "$ref": "#/definitions/impactQuantification"
        },
        "description": {
          "type": "string",
          "description": "Description of the potential impact"
        }
      }
    },
    "impactQuantification": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "financialLoss": {
          "type": "number",
          "description": "Estimated financial loss in currency units"
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$",
          "description": "ISO 4217 currency code"
        },
        "affectedUsers": {
          "type": "integer",
          "description": "Number of affected users"
        },
        "downtime": {
          "type": "string",
          "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(\\d+H)?(\\d+M)?(\\d+(\\.\\d+)?S)?)?$",
          "description": "Expected downtime as ISO 8601 duration"
        },
        "dataRecords": {
          "type": "integer",
          "description": "Number of data records affected"
        },
        "recovery": {
          "type": "string",
          "pattern": "^P(?!$)(\\d+Y)?(